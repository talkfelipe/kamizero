<!-- NOTICE SHOW PAGE -->
<div class="notice-page notice-show-page">
  <div class="notice-show-wrapper">

    <!-- HEADER: BACK (same markup as index) -->
    <div class="notice-header my-3">
      <%= link_to :back, class: "text-decoration-none notice-back-link" do %>
        <i class="fa-solid fa-angles-left me-1"></i>
        BACK
      <% end %>
    </div>

    <!-- MAIN NOTICE CARD (details) -->
    <div class="card notice-show-card shadow-sm bg-white">
      <div
        data-controller="mark-read"
        data-mark-read-url-value="<%= mark_as_read_notice_path(@notice, format: :json) %>">
        <div class="card-body position-relative">
          <span class="badge rounded-pill notice-category-badge
            <%= @notice.category == "Event" ? "bg-warning" : "bg-dark" %>">
            <%= @notice.category == "Event" ? "Event" : "General" %>
          </span>

          <h2 class="card-title notice-show-title mb-3">
            <%= @notice.title %>
          </h2>

          <div class="mb-3 d-flex flex-wrap gap-2 notice-meta-pills">
            <span class="badge rounded-pill pill-meta">
              School: <%= @notice.school.name %>
            </span>
            <% if @notice.classroom %>
              <span class="badge rounded-pill pill-meta">
                Grade: <%= @notice.classroom.grade %>
              </span>
              <span class="badge rounded-pill pill-meta">
                Class: <%= @notice.classroom.name %>
              </span>
            <% else %>
              <span class="badge rounded-pill pill-meta">
                Grade: All
              </span>
              <span class="badge rounded-pill pill-meta">
                Class: All
              </span>
            <% end %>
          </div>

          <div class="mt-3 notice-show-content">
            <% if @notice.category == "Event" %>
              <div class="notice-event-meta mb-2">
                <div>Date: <%= @notice.date %></div>
                <div>Start Time: <%= @notice.start_time&.strftime("%H:%M") %></div>
                <div>End Time: <%= @notice.end_time&.strftime("%H:%M") %></div>
              </div>
            <% end %>

            <%= markdown(@notice.content) %>

            <div class="notice-attachment-wrapper mt-3">
              <% if @notice.attachment.attached? %>
                <%= image_tag @notice.attachment,
                              alt: "Resource Image",
                              class: "img-fluid rounded notice-attachment-image" %>
              <% end %>
            </div>
          </div>

          <div class="mt-3">
            <% if @notice.category == "Event" %>
              <%= link_to "Add to Google Calendar",
                  google_calendar_url_for(@notice),
                  class: "btn button-view-all btn-sm",
                  target: "_blank",
                  rel: "noopener" %>
            <% end %>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>
