<div class="container notice-page notices-page">
  <!-- BACK + PAGE TITLE + SUBTITLE (same as create header) -->
  <div class="notice-header">
    <%= link_to dashboard_path, class: "text-decoration-none text-secondary" do %>
      <i class="fa-solid fa-angles-left"></i> <strong>BACK</strong>
    <% end %>
    <h2>All Notes</h2>
  </div>
  <!-- NOTICES LIST (original) -->
  <div class="notices-list">
    <% @notes.each do |note| %>
      <%= link_to note_path(note), class: "notice-card position-relative" do %>
        <div class="notice-card-icon">
          <i class="fa-solid fa-book"></i>


    <% if current_user.role == "parent" && @students_for_dropdown.present? %>
      <div class="dropdown">
        <button class="btn button-view-all dropdown-toggle"
                type="button"
                id="createNoteDropdown"
                data-bs-toggle="dropdown"
                aria-expanded="false">
          <i class="fa-solid fa-square-plus"></i>
          CREATE NOTES
        </button>

        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="createNoteDropdown">
          <% @students_for_dropdown.each do |student| %>
            <li>
              <%= link_to new_student_note_path(student),
                class: "dropdown-item" do %>
                <i class="fa-solid fa-user-graduate me-1"></i>
                <%= "#{student.name} (#{student.classroom.grade}#{student.classroom.name} Class)" %>
              <% end %>
            </li>
          <% end %>
        </ul>
      </div>
    <% end %>
  <div>

  </div>
  <!-- MAIN WHITE CARD (wraps filters + list) -->
  <div class="notice-index-card">
    <!-- FILTERS (original) -->
    <div class="notices-filters-card">
      <%= simple_form_for :filters, url: notes_path, method: :get,
                          html: { class: "notice-filters" } do |f| %>
        <!-- Search -->
        <div class="filter-item search-box">
          <i class="fa-solid fa-magnifying-glass"></i>
          <%= f.input :q,
            wrapper: false,
            label: false,
            input_html: {
              placeholder: "Search notes...",
              class: "filter-input",
              value: params.dig(:filters, :q)
            } %>
        </div>
        <!-- Main Content -->
        <div class="notice-card-main">
          <!-- School / Grade / Class pills -->
          <div class="mb-3 d-flex flex-wrap gap-2 notice-meta-pills">
            <span class="badge rounded-pill pill-meta" id="pills">
              Grade: <%= note.student.classroom.grade %>
            </span>
            <span class="badge rounded-pill pill-meta" id="pills">
              Class: <%= note.student.classroom.name %>
            </span>
          </div>
          <p>Name: <%= note.student.name %></p>
          <div class="notice-card-header">
            <h2 class="notice-card-title"><%= note.title %></h2>
          </div>
          <p class="notice-card-body">
            <%= truncate(strip_tags(note.content), length: 100) %>
          </p>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
